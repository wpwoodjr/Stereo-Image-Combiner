<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stereo Image Combiner - Help</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            /* No custom scrollbar styling */
        }
        h1 {
            color: #b0b0b0;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        h2 {
            color: #b0b0b0;
            margin-top: 30px;
            border-left: 4px solid #555;
            padding-left: 10px;
        }
        h3 {
            color: #b0b0b0;
            margin-top: 20px;
        }
        .section {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            /* Ensure overflow uses default browser scrolling */
            overflow: auto;
        }
        .shortcut {
            display: inline-block;
            background-color: #333;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            margin: 0 3px;
        }
        ul, ol {
            padding-left: 25px;
        }
        li {
            margin-bottom: 8px;
        }
        .tip {
            background-color: #2a3038;
            border-left: 4px solid #4a7eb5;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }
        .warning {
            background-color: #382a30;
            border-left: 4px solid #b54a4a;
            padding: 10px 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }
        .tab-container {
            display: flex;
            border-bottom: 1px solid #444;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab {
            padding: 10px 20px;
            background-color: #1e1e1e;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        .tab.active {
            background-color: #333;
            font-weight: bold;
        }
        .tab-content {
            display: none;
            /* Use default scrollbars */
            overflow: visible;
        }
        .tab-content.active {
            display: block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #444;
            background-color: #272727;
        }
        td {
            padding: 8px;
            border-bottom: 1px solid #333;
        }
        
        /* Additional responsive styles */
        @media (max-width: 768px) {
            h1 {
                font-size: 24px;
            }
            .tab {
                padding: 8px 15px;
                font-size: 14px;
            }
            .section {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <h1>Stereo Image Combiner - Help</h1>
    
    <div class="tab-container">
        <div class="tab active" onclick="openTab('basics')">Basics</div>
        <div class="tab" onclick="openTab('cropping')">Cropping</div>
        <div class="tab" onclick="openTab('workflow')">Workflow</div>
        <div class="tab" onclick="openTab('advanced')">Advanced</div>
        <div class="tab" onclick="openTab('shortcuts')">Shortcuts</div>
    </div>
    
    <div id="basics" class="tab-content active">
        <div class="section">
            <h2>Getting Started</h2>
            <p>Stereo Image Combiner is a web-based tool that lets you combine images side by side for stereo viewing,
                with customizable border, color, and cropping options.
                It works on mobile, touch devices, and desktop.
            </p>
            
            <h3>Loading Images</h3>
            <ol>
                <li>Drag and drop one or two images onto the drop zone, or</li>
                <li>Click the drop zone to open a file browser (hold Ctrl or âŒ˜ to select two images)</li>
                <li>If just one image is loaded, it will be assumed to be a stereo pair and will be split into two with borders pre-cropped
                    (click "Reset Crop" to restore the borders, or "Crop Images" to tweak the crop)</li>
                <li>Once loaded, both images will be displayed side by side</li>
            </ol>
            
            <h3>Basic Controls</h3>
            <ul>
                <li><strong>Swap Images:</strong> Switches the left and right images (useful for changing from cross-eyed to parallel viewing)</li>
                <li><strong>Scale Slider:</strong> Adjusts the preview size without affecting the final output</li>
                <li><strong>Gap / Border Width Slider:</strong> Adjusts the space around images (0-20% of average image width)</li>
                <li><strong>Color:</strong> Changes the color of the gap and borders</li>
                <li><strong>Borders:</strong> Toggles drawing a border around the images equal in width to the gap</li>
                <li><strong>Transparent:</strong> Makes the gap and borders transparent instead of colored</li>
                <li><strong>Corner Radius:</strong> Sets the radius of the curved image corners</li>
            </ul>
            
            <h3>Saving Your Image</h3>
            <ol>
                <li>Enter an optional filename prefix</li>
                <li>Select your preferred format (JPG or PNG)</li>
                <li>For JPG, adjust the quality setting</li>
                <li>Click "Save Image" to download the combined image</li>
            </ol>
            
            <div class="tip">
                <strong>Tip:</strong> PNG format preserves transparency and provides highest quality, but produces larger files. JPG is more space-efficient but uses lossy compression.
            </div>
        </div>
    </div>
    
    <div id="cropping" class="tab-content">
        <div class="section">
            <h2>Image Cropping</h2>
            <p>The cropping feature allows you to select matching regions from both images with synchronized dimensions.</p>
            
            <h3>Starting Crop Mode</h3>
                <li>Click the "Crop Images" button to enter crop mode.  By default align mode is active.</li>
                <li>The images will be displayed with a crop box overlaid</li>
                <li>Note, images may already have been automatically cropped to the borders</li>
            
            <h3>Crop Box Controls</h3>
            <ul>
                <li><strong>Resize:</strong> Drag any handle (corner or edge) to resize both crop boxes simultaneously while maintaining the same dimensions</li>
                <li><strong>Move:</strong> Click inside a crop box and drag to reposition the image relative to the other image.
                </li>
                <li><strong>Moving Both Images Together:</strong> Click and drag outside both crop boxes for synchronized movement of both images
                <ul>
                    <li>When "Synchronized Movement" is checked, movement is synchoronized even when clicking inside the crop boxes</li>
                    <li>In align mode, images always move relative to each other when clicking and dragging <i>inside</i> the crop box,
                        and move together when clicking and dragging <i>outside</i> the crop box</li>
                </ul>
                </li>
            </ul>
            
            <h3>Align Mode</h3>
            <p>Align mode (default) provides a special overlay view to help you precisely align the two images.</p>
            <ul>
                <li>Click inside the crop box, and the images appear overlaid with inverse grayscale coloring to highlight differences</li>
                <li>Click and drag the image to align key features.  A feature is aligned when it turns a uniform gray color.</li>
                <li>Click and drag outside the crop box to move the crop box relative to the images.</li>
                <li>Click the "Align Mode" checkbox or press the <span class="shortcut">a</span> key to toggle between align mode and side-by-side mode</li>
            </ul>

            <h3>Movement Controls</h3>
            <ul>
                <li>When dragging a crop box, you'll initially have freedom to move in any direction</li>
                <li>As you drag a bit further, the system detects your primary direction of movement:
                    <ul>
                        <li>Horizontal movement locks to left/right only</li>
                        <li>Vertical movement locks to up/down only</li>
                        <li>Diagonal movement allows movement in both directions</li>
                    </ul>
                </li>
                <li>Fine-grained control is active when moving near the starting point</li>
            </ul>
            
            <h3>Applying or Canceling a Crop</h3>
            <ul>
                <li>Click "Apply Crop" to confirm your selection</li>
                <li>Click "Cancel" to exit crop mode without changes</li>
                <li>Click "Reset Crop" to restore the original images, or "Crop Images" to continue where you left off.</li>
            </ul>
        </div>
    </div>
    
    <div id="workflow" class="tab-content">
        <div class="section">
            <h2>Workflow</h2>
            <p>For smooth workflow, the steps below are recommended.</p>
            
            <h3>Load Images</h3>
                <li>Click on the dropzone or drag and drop the image(s) onto the dropzone to load the images</li>
                <li>In Chrome, you can drag an existing stereo image from another web page onto the drop zone</li>
                <li>The images will be displayed side by side, with any borders pre-cropped</li>
                <li>Swap the images as needed to achieve a cross stereo view or parallel stereo view</li>
            
            <h3>Aligning</h3>
            <ul>
                <li>Enter crop mode and activate align mode initially</li>
                <li>The images are overlaid and a crop box is shown</li>
                <li>Adjust "Display Scale" as necessary</li>
                <li>Click and drag inside the crop box to align a region or feature in the images</li>
                <ul>
                    <li>The images appear overlaid with inverse grayscale coloring to highlight differences</li>
                    <li>To achieve pleasing stereo depth, typically you want to align the objects which are closest to the viewer,
                    so that the image extends behind the viewing window and not in front of the border of the window (creating a "window violation")</li>
                    <li>For example, for a stereo image of a mountain with a bush close to the viewer, align the bush, or the ground in front of the bush</li>
                    <li>An area is aligned when it looks a uniform gray</li>
                    <li>Use the arrow keys for precision aligning at the pixel level (note the cursor must be inside the crop area, otherwise both images are moved together)</li>
                </ul>
                <li>Adjust the crop box size</li>
                <li>Move the crop box by clicking and dragging on the images outside the crop box
                <ul>
                    <li>The crop box will move over both images allowing them to be framed</li>
                </ul>
            </ul>
            
            <h3>Refining</h3>
            <p>Side-by-side mode provides a preview of how the images will look when cropped, while also allowing adjustments to the crop.</p>
            <ul>
                <li>Uncheck "Align Mode" or press the <span class="shortcut">a</span> key to switch to side-by-side mode</li>
                <li>The images are displayed with crop boxes overlaid on each image for viewing in stereo</li>
                <ul>
                    <li>Check that the stereo view is pleasing</li>
                    <li>Return to align mode to tweak the alignment</li>
                </ul>
                <li>Adjust the crop boxes' size with the resize handles and position by clicking and dragging</li>
                <ul>
                    <li>Images can be moved independently if "Synchronized Movement" is unchecked, however this isn't recommended if they were aligned properly in align mode</li>
                    <li>You can check "Horizontal Only" to prevent further relative vertical movement of the images</li>
                </ul>
                <li>Adjust the gap width for comfortable viewing</li>
            </ul>

            <h3>Finishing</h3>
            <ul>
                <li>Apply the crop</li>
                <li>Tweak border / gap width, corner radius, and color settings</li>
                <ul>
                    <li>Transparency is useful when you don't know the color of the page the image will be displayed on</li>
                    <li>Borders are optional and would depend on how the image is to be displayed</li>
                </ul>
                <li>Enter a filename prefix to help identify the images, for example "cross -" or "parallel -"</li>
                <li>Save the images</li>
                <ul>
                    <li>A file name with prefix is generated automatically</li>
                    <li>On some systems the file name can be modified before saving</li>
                </ul>
                <li>To process new images, click on the cropped images or drag and drop two files onto the cropped images</li>
            </ul>
        </div>
    </div>
    
    <div id="advanced" class="tab-content">
        <div class="section">
            <h2>Advanced Features</h2>
            
            <h3>Fullscreen Mode</h3>
            <p>For a larger view of your images:</p>
            <ul>
                <li>Click the fullscreen button in the top-right corner of the canvas</li>
                <li>Or press the <span class="shortcut">f</span> key</li>
                <li>To exit fullscreen mode, click the fullscreen return button in the top-right corner of the screen</li>
                <li>Or press the <span class="shortcut">f</span> key or <span class="shortcut">Esc</span></li>
            </ul>
            
            <h3>Synchronized Movement</h3>
            <p>When in side-by-side crop mode, you can enable synchronized image movement so that images keep their alignment.</p>
            <ul>
                <li>Check the "Synchronized Movement" checkbox</li>
                <li>Useful for maintaining alignment between stereo pairs</li>
                <li>Images move together when using touch or the mouse</li>
                <li>When using the arrow keys, relative movement between images is still allowed for fine tuning</li>
                <li>In align mode, synchronized movement is disabled to allow relative image movement</li>
            </ul>

            <h3>Horizontal-Only Movement</h3>
            <p>When in crop mode, you can enable horizontal-only movement to restrict adjustments to the left-right axis.</p>
            <ul>
                <li>Check the "Horizontal Only" checkbox or press the <span class="shortcut">h</span> key</li>
                <li>Useful for maintaining vertical alignment between stereo pairs</li>
            </ul>
            
            <h3>Draw Boxes Option</h3>
            <p>Toggle the display of crop box outlines with the "Draw Boxes" checkbox.</p>
            
            <h3>Fine-Tuning with Arrow Keys</h3>
            <p>When in crop mode, you can use arrow keys for precise adjustments:</p>
            <ul>
                <li>Arrow keys move the active image(s) by 1 pixel</li>
                <li>Hold <span class="shortcut">Shift</span> + arrow keys for 5-pixel movements</li>
                <li>An image is active when the cursor is inside its crop box.
                    If the cursor is outside any crop box, both images are moved together. Or,</li>
                <li>In side-by-side mode, press <span class="shortcut">Tab</span> to to cycle between moving the left image, the right image, and both images</li>
                <ul>
                    <li>In align mode, <span class="shortcut">Tab</span> toggles between moving the images together under the crop box, or moving one image relative to the other.</li>
                    <li>Even if "Synchronized Movement" is checked, images can move relative to each other when using the arrow keys.</li>
                </ul>
            </ul>
            
            <h3>Image Replacement</h3>
            <p>To replace your images without resetting all settings:</p>
            <ul>
                <li>Drag and drop new images directly onto the canvas area</li>
                <li>Or click on the canvas to open the file browser (only works when not in crop mode)</li>
            </ul>
            
            <div class="tip">
                <strong>Tip:</strong> Settings like gap size, color, and scale preference are saved between sessions in your browser's local storage.
            </div>
        </div>
    </div>
    
    <div id="shortcuts" class="tab-content">
        <div class="section">
            <h2>Keyboard Shortcuts</h2>
            <p>Keyboard shortcuts can speed up your workflow:</p>
            
            <table>
                <tr>
                    <th>Key</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td><span class="shortcut">x</span></td>
                    <td>Swap left and right images</td>
                </tr>
                <tr>
                    <td><span class="shortcut">f</span></td>
                    <td>Toggle fullscreen mode</td>
                </tr>
                <tr>
                    <td><span class="shortcut">a</span></td>
                    <td>Toggle align mode (in crop mode)</td>
                </tr>
                <tr>
                    <td><span class="shortcut">h</span></td>
                    <td>Toggle horizontal-only movement (in crop mode)</td>
                </tr>
                <tr>
                    <td><span class="shortcut">Tab</span></td>
                    <td>Cycle between selecting left box, right box, and both boxes (in crop mode)</td>
                </tr>
                <tr>
                    <td><span class="shortcut">Arrow Keys</span></td>
                    <td>Move image(s) under the active crop box(es) by 1 pixel</td>
                </tr>
                <tr>
                    <td><span class="shortcut">Shift</span> + <span class="shortcut">Arrow Keys</span></td>
                    <td>Move image(s) under the active crop box(es) by 5 pixels</td>
                </tr>
                <tr>
                    <td><span class="shortcut">Esc</span></td>
                    <td>Exit fullscreen mode</td>
                </tr>
                <tr>
                    <td><span class="shortcut">?</span></td>
                    <td>Show this help screen</td>
                </tr>
            </table>
        </div>
    </div>
    
    <script>
        function openTab(tabName) {
            // Hide all tab content
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            // Remove active class from all tabs
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // Show the selected tab content and mark the tab as active
            document.getElementById(tabName).classList.add('active');
            
            // Find the clicked tab and add active class
            const tabButtons = document.getElementsByClassName('tab');
            for (let i = 0; i < tabButtons.length; i++) {
                if (tabButtons[i].textContent.toLowerCase().includes(tabName)) {
                    tabButtons[i].classList.add('active');
                    break;
                }
            }
        }
    </script>
</body>
</html>